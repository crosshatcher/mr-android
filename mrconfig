# vim:fenc=utf-8:ft=dosini:ts=2:sts=2:sw=2:et:

[DEFAULT]
include = 
	cat ~/.config/mr/mr-stow-plugin 2>/dev/null || true
	cat ~/.config/mr/mr-hooks 2>/dev/null || true
lib = . ~/.config/mr/mr-functions

[.config/mr]
order = 1
name = mr-android
chain = true
checkout = git clone ssh://git@github.com/crosshatcher/mr-android.git
remotes = git_add_remote local ssh://git@rpi3.homelab/srv/git/mr-android.git
fixups =
  ensure_symlink_exists ~/.mrconfig $MR_REPO/mrconfig
  ensure_symlink_exists ~/.stow-global-ignore $MR_REPO/.stow-global-ignore

[$HOME/.GIT/dev-vcs/kitenet-mr]
checkout = git clone ssh://git@github.com/wandsas/kitenet-mr.git $MR_REPO
remotes = git_add_remote local ssh://git@rpi3.homelab/srv/git/kitenet-mr.git
fixups = make install	

[$HOME/.password-store]
name = pass-crosshatcher
checkout = git clone ssh://git@rpi3.homelab/srv/git/crosshatcher/pass-crosshatcher.git $MR_REPO
post_checkout = chmod go-rwx $MR_REPO

[$HOME/.GIT/android/dotfiles-android]
stowable = true
checkout = git clone ssh://git@github.com/crosshatcher/dotfiles-android.git
remotes = git_add_remote local ssh://git@rpi3.homelab/srv/git/dotfiles-android.git

[$HOME/.SpaceVim]
checkout = git clone git://github.com/SpaceVim/SpaceVim.git $MR_REPO
remotes = git_add_remote local ssh://git@rpi3.homelab/srv/git/SpaceVim.git
skip = true

[$HOME/.vim]
checkout = git clone ssh://git@github.com/wandsas/vim-config.git $MR_REPO
post_checkout =
  cd $MR_REPO
  git config pull.ff only
  git branch --set-upstream-to=origin/master master
remotes = git_add_remote local git://git@rpi3.homelab/srv/git/wandsas/vim-config.git
fixups =
  [ -L ~/.vimrc ] || ln -s ~/.vim/vimrc.wandsas ~/.vimrc
  [ -L ~/.gvimrc ] || ln -s ~/.vim/gvimrc.wandsas ~/.gvimrc

[$HOME/.GIT/dev-vcs/diff-so-fancy]
checkout = git clone git://github.com/so-fancy/diff-so-fancy.git $MR_REPO
post_checkout =
  cd $MR_REPO
  git config pull.ff only
  git branch --set-upstream-to=origin/master master
remotes = git_add_remote local ssh://git@rpi3.homelab:/srv/git/diff-so-fancy.git
fixups =
  [ -f ~/.local/bin/diff-so-fancy ] && return
  ./third_party/build_fatpack/build.pl
  mkdir -p ~/.local/bin
  install -m 755 /tmp/diff-so-fancy ~/.local/bin/diff-so-fancy

[$HOME/.local/lib/rbenv]
checkout = git clone git://github.com/rbenv/rbenv.git $MR_REPO
skip = true

[$HOME/.local/lib/pyenv]
checkout = git clone git://github.com/pyenv/pyenv.git $MR_REPO
fixups = src/configure && make -C src
skip = true

[$HOME/.local/lib/nvm]
checkout = git clone -b v0.38.0 git://github.com/nvm-sh/nvm.git $MR_REPO
update = git pull origin v0.38.0
fixups =
  [ -f ~/.npmrc ] || echo "prefix=${HOME}/.npm-global
  ( -d ~/.npm-global

[$HOME/android/myandroid]
checkout = git clone ssh://git@github.com/wandsas/myandroid.git $MR_REPO
remotes = git_add_remote local ssh://git@rpi3.homelab/srv/git/myandroid.git
fixups = 
	[ -L ~/android/envsetup.sh ] || ln -s ~/android/myandroid/envsetup.sh ~/android
skip = ! android_dev_env

[$HOME/src/k9mail]
checkout = git clone ssh://git@github.com/crosshatcher/k9mail.git $MR_REPO
remotes = 
	git_add_remotes "
	  local ssh://git@rpi3.homelab/srv/git/k9mail.git
	  upstream git://github.com/k9mail/k-9.git"
skip = ! android_dev_env

[$HOME/src/orbot]
checkout = git clone ssh://git@github.com/crosshatcher/orbot.git $MR_REPO
post_checkout =
  git submodule init
  git submodule update --recursive
remotes = 
	git_add_remotes "
	  local ssh://git@rpi3.homelab/srv/git/orbot.git
	  upstream git://github.com/guardianproject/orbot.git"
skip = ! android_dev_env


[$HOME/src/open-keychain]
checkout = git clone ssh://git@github.com/crosshatcher/open-keychain.git $MR_REPO
post_checkout =
  git submodule init
  git submodule update --recursive
remotes = 
	git_add_remotes "
	  local ssh://git@rpi3.homelab/srv/git/open-keychain.git
	  upstream git://github.com/open-keychain/open-keychain.git"
skip = ! android_dev_env
